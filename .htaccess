# ============================================================================
# WordPress Security .htaccess Konfiguration
# ============================================================================
# Diese Regeln implementieren wichtige Sicherheitsmassnahmen zum Schutz
# einer WordPress-Installation vor Zugriffen auf sensible Dateien und
# vor PHP-Code-Ausf√ºhrung in Upload-Verzeichnissen.
#
# WICHTIG: Diesen Code in die .htaccess-Datei im WordPress Root-Verzeichnis
# einf√ºgen oder als separate Bl√∂cke strukturieren.
#
# VORAUSSETZUNG: Apache 2.4+ (bei √§lteren Versionen "Order deny,allow"
# statt "Require all denied" nutzen)
# ============================================================================


# ============================================================================
# PRIORISIERUNG DER REGELN
# ============================================================================
# üî• MUSS HABEN: Regeln 1, 2 und 5 (kritische Sicherheit)
# ‚ö° SOLLTE HABEN: Regeln 3 und 4 (erh√∂hter Schutz)
# üí° OPTIONAL: Zus√§tzliche Empfehlungen am Ende
# ============================================================================


# ============================================================================
# 1. wp-config.php sch√ºtzen üî• MUSS HABEN
# ============================================================================
# Die wp-config.php enth√§lt sensible Informationen wie Datenbank-Zugangsdaten,
# Security-Keys und andere kritische Konfigurationen. Diese Datei DARF auf
# keinen Fall √∂ffentlich zug√§nglich sein.
#
# ============================================================================
<Files "wp-config.php">
    Require all denied
</Files>


# ============================================================================
# 2. .htaccess selbst sch√ºtzen üî• MUSS HABEN
# ============================================================================
# Die .htaccess-Datei selbst k√∂nnte von Angreifern eingesehen oder manipuliert
# werden. Dieser Block verhindert direkten Zugriff darauf.
#
# ============================================================================
<Files ".htaccess">
    Require all denied
</Files>


# ============================================================================
# 3. XML-RPC blockieren ‚ö° SOLLTE HABEN (optional, je nach Anforderung)
# ============================================================================
# XML-RPC (xmlrpc.php) wurde traditionell f√ºr Remote-Ver√∂ffentlichung von
# Posts und Plugin-Funktionen genutzt. Heute ist es oft unn√∂tig und kann
# f√ºr Brute-Force-Attacken und DDoS-Angriffe missbraucht werden.
#
#
# ‚ö†Ô∏è ACHTUNG: Folgende Plugins/Dienste ben√∂tigen XML-RPC:
# - Jetpack (WordPress.com Verbindung)
# - Mobile Apps f√ºr WordPress
# - Viele Backup-Plugins (z.B. BlogVault, ManageWP)
# - Externe Publishing-Tools
#
# EMPFEHLUNG: Nur blockieren, wenn diese Dienste NICHT genutzt werden!
# Im Zweifelsfall erstmal NICHT aktivieren und sp√§ter testen.
# ============================================================================
<Files "xmlrpc.php">
    Require all denied
</Files>


# ============================================================================
# 4. Sensible Dateien verbergen ‚ö° SOLLTE HABEN (Version-Disclosure)
# ============================================================================
# Diese Dateien geben Informationen √ºber die WordPress-Version preis,
# was Angreifern bei der Suche nach bekannten Sicherheitsl√ºcken hilft.
#
# Dateien:
# - readme.html: Enth√§lt WordPress-Version und Lizenzinformation
# - license.txt: GPL-Lizenztext mit Versionsinformation
# - wp-config-sample.php: Beispiel-Konfiguration (sollte nicht vorhanden sein)
#
#
# TIPP: Diese Dateien k√∂nnen auch einfach manuell gel√∂scht werden (noch besser!)
# ============================================================================
<FilesMatch "^(readme\.html|license\.txt|wp-config-sample\.php)">
    Require all denied
</FilesMatch>


# ============================================================================
# 5. PHP-Ausf√ºhrung im Uploads-Ordner verhindern üî• MUSS HABEN (KRITISCH!)
# ============================================================================
# Der wp-content/uploads/ Ordner ist das Ziel h√§ufiger Angriffe. Wenn
# Angreifer Dateien hochladen k√∂nnen (z.B. durch Plugin-Schwachstellen),
# k√∂nnen sie mit dieser Regel keinen PHP-Code ausf√ºhren.
#
#
# EMPFOHLENE METHODE (einfacher und sicherer):
# ============================================================================
# Erstelle eine SEPARATE .htaccess-Datei direkt im uploads-Ordner:
#
# Pfad: /wp-content/uploads/.htaccess
#
# Inhalt:
# --------
# <Files "*.php">
#     Require all denied
# </Files>
# --------
#
# Vorteile:
# ‚úì Funktioniert unabh√§ngig vom Installationspfad
# ‚úì Einfacher zu verwalten
# ‚úì Bessere Performance
# ============================================================================


# ============================================================================
# ALTERNATIVE METHODE (nur wenn separate .htaccess nicht m√∂glich):
# ============================================================================
# Falls du die Regel hier in der Haupt-.htaccess haben m√∂chtest, nutze diese
# Version. WICHTIG: Pfad muss an deine Installation angepasst werden!
# ============================================================================
# <Directory "/var/www/html/wp-content/uploads/">
#     <FilesMatch "\.php$">
#         Require all denied
#     </FilesMatch>
# </Directory>
#
# BEISPIELE f√ºr verschiedene Installationen:
# - Standard-Installation: /var/www/html/wp-content/uploads/
# - Subdomain: /var/www/vhosts/example.com/httpdocs/wp-content/uploads/
# - Unterverzeichnis: /var/www/html/blog/wp-content/uploads/
# - cPanel: /home/username/public_html/wp-content/uploads/
#
# Den exakten Pfad findest du in deinem Hosting-Panel oder via FTP/SSH.
# ============================================================================


# ============================================================================
# NACH DEM EINF√úGEN TESTEN!
# ============================================================================
# ‚úì Website l√§dt noch normal?
# ‚úì wp-config.php √ºber Browser nicht erreichbar?
#   (Test: https://deine-domain.de/wp-config.php ‚Üí sollte 403 oder 404 zeigen)
# ‚úì Alle Plugins funktionieren noch?
# ‚úì Bilder im Uploads-Ordner werden noch angezeigt?
# ‚úì Falls XML-RPC blockiert: Jetpack/Mobile Apps noch funktionsf√§hig?
# ============================================================================


# ============================================================================
# ZUS√ÑTZLICHE EMPFEHLUNGEN üí° OPTIONAL
# ============================================================================
#
# 1. Version-Header entfernen (weiterer Schutz vor Version-Disclosure):
#    <IfModule mod_headers.c>
#        Header always unset X-Powered-By
#        Header unset X-Powered-By
#    </IfModule>
#
# 2. Verzeichnis-Listings verhindern (falls nicht bereits aktiv):
#    Options -Indexes
#
# 3. Zugriff auf versteckte Dateien blockieren (.git, .env, etc.):
#    <FilesMatch "^\.">
#        Require all denied
#    </FilesMatch>
#
# 4. Regelm√§ssig Backups machen und Plugins/Themes aktuell halten!
#    Sicherheit ist ein fortlaufender Prozess, keine einmalige Massnahme.
#
# ============================================================================